<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. ELA Pivot &mdash; NYC Schools Open Data 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../_static/custom.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> NYC Schools Open Data
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01-Basics/index.html">1. Data Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-Combining-Data/index.html">Combining Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-Graphs-and-Charts/index.html">Graphs &amp; Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-Statistics/index.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-Maps-and-GIS/index.html">2. Maps &amp; GIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data-sources.html">Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/nycschools.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NYC Schools Open Data</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">10. </span>ELA Pivot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/nb/_archive/ela-pivot.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="ELA-Pivot">
<h1><span class="section-number">10. </span>ELA Pivot<a class="headerlink" href="#ELA-Pivot" title="Permalink to this heading"></a></h1>
<p>This notebook uses <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to convert our ““<a class="reference external" href="https://www.statology.org/long-vs-wide-data/">long</a>”” dataframe to a wide dataframe. This is called re-shaping.</p>
<p>The NYC DOE provides the ELA test scores in long format. There is a column called <code class="docutils literal notranslate"><span class="pre">category</span></code> that repeats the same 14 unique values (<em>e.g.</em> “All Students”, “Asian”, “Never ELL”, …) In this long format, we have 424,676 rows of data. Each row is the observation of a school (dbn), academic year, grade level, and demographic category. The test results are then reported in the following columns: - number_tested - mean_scale_score - level_1 - level_1_pct - level_2 - level_2_pct - level_3 -
level_3_pct - level_4 - level_4_pct - level_3_4 - level_3_4_pct</p>
<p>There is nothing wrong with this long format and it’s the best format for some types of analysis and visualizations. However, some types of analysis are easier with a “wide” data format, where we re-shape the categories into columns.</p>
<p>For example, let’s say that we want to rank schools on closing the achievment gap between ELL students and “never ELL” students. We want a new column called <code class="docutils literal notranslate"><span class="pre">ELL_gap</span></code>. The long format makes this very challenging.</p>
<p>To simplify this working example, we are going to ignore all of the columns that begin with <code class="docutils literal notranslate"><span class="pre">level</span></code>. We have the following 14 categories: 1. All Students 2. SWD 3. Not SWD 4. Asian 5. Black 6. Hispanic 7. White 8. Female 9. Male 10. Econ Disadv 11. Not Econ Disadv 12. Current ELL 13. Ever ELL 14. Never ELL</p>
<p>We are going to reshape our data so that we add 2 columns for each category, “number_tested_all_students”, “number_tested_asian”, “mean_scale_score_all_students”, “mean_scale_score_asian”, etc.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># load the data from the csv file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;ela-combined.csv&quot;</span><span class="p">)</span>

<span class="c1"># get only the columns we&#39;re interested in</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;dbn&quot;</span><span class="p">,</span> <span class="s2">&quot;grade&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;number_tested&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_scale_score&quot;</span><span class="p">]]</span>

<span class="c1"># drop the rows with NaN (where the pop is too small to report)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;mean_scale_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>

<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;mean_scale_score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dbn</th>
      <th>grade</th>
      <th>year</th>
      <th>category</th>
      <th>number_tested</th>
      <th>mean_scale_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>110210</th>
      <td>04M012</td>
      <td>4</td>
      <td>2018</td>
      <td>White</td>
      <td>12</td>
      <td>646.833313</td>
    </tr>
    <tr>
      <th>221758</th>
      <td>03M859</td>
      <td>5</td>
      <td>2019</td>
      <td>Female</td>
      <td>8</td>
      <td>645.875000</td>
    </tr>
    <tr>
      <th>109676</th>
      <td>03M859</td>
      <td>5</td>
      <td>2019</td>
      <td>White</td>
      <td>8</td>
      <td>645.125000</td>
    </tr>
    <tr>
      <th>339438</th>
      <td>30Q300</td>
      <td>6</td>
      <td>2018</td>
      <td>Econ Disadv</td>
      <td>18</td>
      <td>644.444458</td>
    </tr>
    <tr>
      <th>417362</th>
      <td>30Q122</td>
      <td>7</td>
      <td>2019</td>
      <td>Ever ELL</td>
      <td>8</td>
      <td>643.875000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>395682</th>
      <td>22K052</td>
      <td>5</td>
      <td>2016</td>
      <td>Current ELL</td>
      <td>6</td>
      <td>212.500000</td>
    </tr>
    <tr>
      <th>407321</th>
      <td>27Q043</td>
      <td>5</td>
      <td>2016</td>
      <td>Current ELL</td>
      <td>7</td>
      <td>212.142853</td>
    </tr>
    <tr>
      <th>357181</th>
      <td>06M328</td>
      <td>7</td>
      <td>2015</td>
      <td>Current ELL</td>
      <td>22</td>
      <td>208.727280</td>
    </tr>
    <tr>
      <th>62510</th>
      <td>15K094</td>
      <td>4</td>
      <td>2013</td>
      <td>SWD</td>
      <td>11</td>
      <td>207.272720</td>
    </tr>
    <tr>
      <th>63584</th>
      <td>15K497</td>
      <td>8</td>
      <td>2013</td>
      <td>SWD</td>
      <td>6</td>
      <td>193.333328</td>
    </tr>
  </tbody>
</table>
<p>334104 rows × 6 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we pivot the category column and then</span>
<span class="c1"># rename the columns to make them all lowercase with underscors instead of spaces</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dbn&#39;</span><span class="p">,</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number_tested&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_scale_score&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reindex</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>

<span class="c1"># now our dataframe looks like this:</span>
<span class="n">df</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>number_tested_all_students</th>
      <th>number_tested_asian</th>
      <th>number_tested_black</th>
      <th>number_tested_current_ell</th>
      <th>number_tested_econ_disadv</th>
      <th>number_tested_ever_ell</th>
      <th>number_tested_female</th>
      <th>number_tested_hispanic</th>
      <th>number_tested_male</th>
      <th>number_tested_never_ell</th>
      <th>...</th>
      <th>mean_scale_score_econ_disadv</th>
      <th>mean_scale_score_ever_ell</th>
      <th>mean_scale_score_female</th>
      <th>mean_scale_score_hispanic</th>
      <th>mean_scale_score_male</th>
      <th>mean_scale_score_never_ell</th>
      <th>mean_scale_score_not_econ_disadv</th>
      <th>mean_scale_score_not_swd</th>
      <th>mean_scale_score_swd</th>
      <th>mean_scale_score_white</th>
    </tr>
    <tr>
      <th>dbn</th>
      <th>grade</th>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">01M015</th>
      <th rowspan="5" valign="top">3</th>
      <th>2013</th>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>15.0</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>285.333344</td>
      <td>285.266663</td>
      <td>292.466675</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>287.157898</td>
      <td>294.375000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>18.0</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>285.111114</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>290.083344</td>
      <td>275.166656</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>16.0</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>...</td>
      <td>281.812500</td>
      <td>NaN</td>
      <td>288.714294</td>
      <td>280.428558</td>
      <td>276.444458</td>
      <td>284.833344</td>
      <td>NaN</td>
      <td>285.125000</td>
      <td>278.500000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>20.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>291.230774</td>
      <td>NaN</td>
      <td>289.937500</td>
      <td>NaN</td>
      <td>304.454559</td>
      <td>277.888886</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>18.0</td>
      <td>14.0</td>
      <td>24.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>308.153839</td>
      <td>300.333344</td>
      <td>297.000000</td>
      <td>303.500000</td>
      <td>NaN</td>
      <td>310.904755</td>
      <td>272.500000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">32K562</th>
      <th rowspan="5" valign="top">All Grades</th>
      <th>2015</th>
      <td>309.0</td>
      <td>NaN</td>
      <td>84.0</td>
      <td>71.0</td>
      <td>276.0</td>
      <td>33.0</td>
      <td>148.0</td>
      <td>212.0</td>
      <td>161.0</td>
      <td>205.0</td>
      <td>...</td>
      <td>278.355072</td>
      <td>285.212128</td>
      <td>280.162170</td>
      <td>275.382080</td>
      <td>273.633545</td>
      <td>281.073181</td>
      <td>263.424255</td>
      <td>279.796814</td>
      <td>263.620697</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>266.0</td>
      <td>NaN</td>
      <td>64.0</td>
      <td>70.0</td>
      <td>248.0</td>
      <td>37.0</td>
      <td>125.0</td>
      <td>194.0</td>
      <td>141.0</td>
      <td>159.0</td>
      <td>...</td>
      <td>284.592743</td>
      <td>292.162170</td>
      <td>285.888000</td>
      <td>282.025787</td>
      <td>281.865234</td>
      <td>290.320740</td>
      <td>272.222229</td>
      <td>287.457550</td>
      <td>269.222229</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>282.0</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>56.0</td>
      <td>247.0</td>
      <td>57.0</td>
      <td>138.0</td>
      <td>204.0</td>
      <td>144.0</td>
      <td>169.0</td>
      <td>...</td>
      <td>287.542511</td>
      <td>298.140350</td>
      <td>289.456512</td>
      <td>286.147064</td>
      <td>283.631958</td>
      <td>291.183441</td>
      <td>279.000000</td>
      <td>290.506928</td>
      <td>273.046143</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>317.0</td>
      <td>NaN</td>
      <td>76.0</td>
      <td>51.0</td>
      <td>290.0</td>
      <td>62.0</td>
      <td>171.0</td>
      <td>232.0</td>
      <td>146.0</td>
      <td>204.0</td>
      <td>...</td>
      <td>592.510315</td>
      <td>598.306457</td>
      <td>595.736816</td>
      <td>593.405151</td>
      <td>588.842468</td>
      <td>594.754883</td>
      <td>593.111084</td>
      <td>594.584961</td>
      <td>584.562500</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>323.0</td>
      <td>NaN</td>
      <td>63.0</td>
      <td>53.0</td>
      <td>306.0</td>
      <td>61.0</td>
      <td>165.0</td>
      <td>251.0</td>
      <td>158.0</td>
      <td>209.0</td>
      <td>...</td>
      <td>592.490173</td>
      <td>600.098389</td>
      <td>597.115173</td>
      <td>592.557739</td>
      <td>588.025330</td>
      <td>595.875610</td>
      <td>595.882324</td>
      <td>594.747192</td>
      <td>582.314819</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>32765 rows × 28 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># next, flatten the columns by resetting the index</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dbn</th>
      <th>grade</th>
      <th>year</th>
      <th>number_tested_all_students</th>
      <th>number_tested_asian</th>
      <th>number_tested_black</th>
      <th>number_tested_current_ell</th>
      <th>number_tested_econ_disadv</th>
      <th>number_tested_ever_ell</th>
      <th>number_tested_female</th>
      <th>...</th>
      <th>mean_scale_score_econ_disadv</th>
      <th>mean_scale_score_ever_ell</th>
      <th>mean_scale_score_female</th>
      <th>mean_scale_score_hispanic</th>
      <th>mean_scale_score_male</th>
      <th>mean_scale_score_never_ell</th>
      <th>mean_scale_score_not_econ_disadv</th>
      <th>mean_scale_score_not_swd</th>
      <th>mean_scale_score_swd</th>
      <th>mean_scale_score_white</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01M015</td>
      <td>3</td>
      <td>2013</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>285.333344</td>
      <td>285.266663</td>
      <td>292.466675</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>287.157898</td>
      <td>294.375000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>01M015</td>
      <td>3</td>
      <td>2014</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>285.111114</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>290.083344</td>
      <td>275.166656</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01M015</td>
      <td>3</td>
      <td>2015</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>...</td>
      <td>281.812500</td>
      <td>NaN</td>
      <td>288.714294</td>
      <td>280.428558</td>
      <td>276.444458</td>
      <td>284.833344</td>
      <td>NaN</td>
      <td>285.125000</td>
      <td>278.500000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01M015</td>
      <td>3</td>
      <td>2016</td>
      <td>20.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>291.230774</td>
      <td>NaN</td>
      <td>289.937500</td>
      <td>NaN</td>
      <td>304.454559</td>
      <td>277.888886</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01M015</td>
      <td>3</td>
      <td>2017</td>
      <td>27.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>308.153839</td>
      <td>300.333344</td>
      <td>297.000000</td>
      <td>303.500000</td>
      <td>NaN</td>
      <td>310.904755</td>
      <td>272.500000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32760</th>
      <td>32K562</td>
      <td>All Grades</td>
      <td>2015</td>
      <td>309.0</td>
      <td>NaN</td>
      <td>84.0</td>
      <td>71.0</td>
      <td>276.0</td>
      <td>33.0</td>
      <td>148.0</td>
      <td>...</td>
      <td>278.355072</td>
      <td>285.212128</td>
      <td>280.162170</td>
      <td>275.382080</td>
      <td>273.633545</td>
      <td>281.073181</td>
      <td>263.424255</td>
      <td>279.796814</td>
      <td>263.620697</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32761</th>
      <td>32K562</td>
      <td>All Grades</td>
      <td>2016</td>
      <td>266.0</td>
      <td>NaN</td>
      <td>64.0</td>
      <td>70.0</td>
      <td>248.0</td>
      <td>37.0</td>
      <td>125.0</td>
      <td>...</td>
      <td>284.592743</td>
      <td>292.162170</td>
      <td>285.888000</td>
      <td>282.025787</td>
      <td>281.865234</td>
      <td>290.320740</td>
      <td>272.222229</td>
      <td>287.457550</td>
      <td>269.222229</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32762</th>
      <td>32K562</td>
      <td>All Grades</td>
      <td>2017</td>
      <td>282.0</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>56.0</td>
      <td>247.0</td>
      <td>57.0</td>
      <td>138.0</td>
      <td>...</td>
      <td>287.542511</td>
      <td>298.140350</td>
      <td>289.456512</td>
      <td>286.147064</td>
      <td>283.631958</td>
      <td>291.183441</td>
      <td>279.000000</td>
      <td>290.506928</td>
      <td>273.046143</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32763</th>
      <td>32K562</td>
      <td>All Grades</td>
      <td>2018</td>
      <td>317.0</td>
      <td>NaN</td>
      <td>76.0</td>
      <td>51.0</td>
      <td>290.0</td>
      <td>62.0</td>
      <td>171.0</td>
      <td>...</td>
      <td>592.510315</td>
      <td>598.306457</td>
      <td>595.736816</td>
      <td>593.405151</td>
      <td>588.842468</td>
      <td>594.754883</td>
      <td>593.111084</td>
      <td>594.584961</td>
      <td>584.562500</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32764</th>
      <td>32K562</td>
      <td>All Grades</td>
      <td>2019</td>
      <td>323.0</td>
      <td>NaN</td>
      <td>63.0</td>
      <td>53.0</td>
      <td>306.0</td>
      <td>61.0</td>
      <td>165.0</td>
      <td>...</td>
      <td>592.490173</td>
      <td>600.098389</td>
      <td>597.115173</td>
      <td>592.557739</td>
      <td>588.025330</td>
      <td>595.875610</td>
      <td>595.882324</td>
      <td>594.747192</td>
      <td>582.314819</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>32765 rows × 31 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;dbn&#39;, &#39;grade&#39;, &#39;year&#39;, &#39;number_tested_all_students&#39;,
       &#39;number_tested_asian&#39;, &#39;number_tested_black&#39;,
       &#39;number_tested_current_ell&#39;, &#39;number_tested_econ_disadv&#39;,
       &#39;number_tested_ever_ell&#39;, &#39;number_tested_female&#39;,
       &#39;number_tested_hispanic&#39;, &#39;number_tested_male&#39;,
       &#39;number_tested_never_ell&#39;, &#39;number_tested_not_econ_disadv&#39;,
       &#39;number_tested_not_swd&#39;, &#39;number_tested_swd&#39;, &#39;number_tested_white&#39;,
       &#39;mean_scale_score_all_students&#39;, &#39;mean_scale_score_asian&#39;,
       &#39;mean_scale_score_black&#39;, &#39;mean_scale_score_current_ell&#39;,
       &#39;mean_scale_score_econ_disadv&#39;, &#39;mean_scale_score_ever_ell&#39;,
       &#39;mean_scale_score_female&#39;, &#39;mean_scale_score_hispanic&#39;,
       &#39;mean_scale_score_male&#39;, &#39;mean_scale_score_never_ell&#39;,
       &#39;mean_scale_score_not_econ_disadv&#39;, &#39;mean_scale_score_not_swd&#39;,
       &#39;mean_scale_score_swd&#39;, &#39;mean_scale_score_white&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<section id="Quick-analysis-with-wide-data">
<h2><span class="section-number">10.1. </span>Quick analysis with wide data<a class="headerlink" href="#Quick-analysis-with-wide-data" title="Permalink to this heading"></a></h2>
<section id="ELL-vs-All-Students">
<h3><span class="section-number">10.1.1. </span>ELL vs All Students<a class="headerlink" href="#ELL-vs-All-Students" title="Permalink to this heading"></a></h3>
<p>Which schools have the best ELA test scores for ELL students compared to never-ELL students?</p>
<p>Let’s compute a new column called <code class="docutils literal notranslate"><span class="pre">ell_delta</span></code> which will be the positive or negative difference in mean test scores betewen the ELL group and the Never ELL group.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ell</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;mean_scale_score_never_ell&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;mean_scale_score_current_ell&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">ell</span><span class="p">[</span><span class="s2">&quot;ell_delta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ell</span><span class="p">[</span><span class="s2">&quot;mean_scale_score_never_ell&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">ell</span><span class="p">[</span><span class="s2">&quot;mean_scale_score_current_ell&quot;</span><span class="p">]</span>
<span class="n">ell</span><span class="p">[[</span><span class="s2">&quot;dbn&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_scale_score_never_ell&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_scale_score_current_ell&quot;</span><span class="p">,</span> <span class="s2">&quot;ell_delta&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;ell_delta&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dbn</th>
      <th>mean_scale_score_never_ell</th>
      <th>mean_scale_score_current_ell</th>
      <th>ell_delta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6488</th>
      <td>07X359</td>
      <td>335.414642</td>
      <td>351.166656</td>
      <td>-15.752014</td>
    </tr>
    <tr>
      <th>407</th>
      <td>01M188</td>
      <td>291.631592</td>
      <td>306.500000</td>
      <td>-14.868408</td>
    </tr>
    <tr>
      <th>10518</th>
      <td>10X360</td>
      <td>279.279999</td>
      <td>292.714294</td>
      <td>-13.434296</td>
    </tr>
    <tr>
      <th>6515</th>
      <td>07X369</td>
      <td>267.465118</td>
      <td>280.577789</td>
      <td>-13.112671</td>
    </tr>
    <tr>
      <th>29729</th>
      <td>30Q111</td>
      <td>266.000000</td>
      <td>276.428558</td>
      <td>-10.428558</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>31669</th>
      <td>31R054</td>
      <td>313.670319</td>
      <td>222.000000</td>
      <td>91.670319</td>
    </tr>
    <tr>
      <th>17477</th>
      <td>18K235</td>
      <td>322.792999</td>
      <td>231.000000</td>
      <td>91.792999</td>
    </tr>
    <tr>
      <th>19316</th>
      <td>20K187</td>
      <td>347.045868</td>
      <td>254.875000</td>
      <td>92.170868</td>
    </tr>
    <tr>
      <th>20988</th>
      <td>22K052</td>
      <td>306.537048</td>
      <td>212.500000</td>
      <td>94.037048</td>
    </tr>
    <tr>
      <th>14857</th>
      <td>15K051</td>
      <td>342.114563</td>
      <td>246.500000</td>
      <td>95.614563</td>
    </tr>
  </tbody>
</table>
<p>14664 rows × 4 columns</p>
</div></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Matthew X. Curinga.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>